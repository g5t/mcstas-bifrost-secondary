DEFINE INSTRUMENT BIFROST_params ()
DECLARE
%{
double params_distances[9][5][2] =
{{{1.1, 1.189}, {1.238, 1.316}, {1.342, 1.42}, {1.443, 1.521}, {1.557, 1.623}}, 
{{1.189, 1.189}, {1.316, 1.316}, {1.42, 1.42}, {1.521, 1.521}, {1.623, 1.623}}, 
{{1.276, 1.189}, {1.392, 1.316}, {1.497, 1.42}, {1.599, 1.521}, {1.701, 1.623}},
 {{1.1, 1.189}, {1.238, 1.316}, {1.342, 1.42}, {1.443, 1.521}, {1.557, 1.623}}, 
{{1.189, 1.189}, {1.316, 1.316}, {1.42, 1.42}, {1.521, 1.521}, {1.623, 1.623}}, 
{{1.276, 1.189}, {1.392, 1.316}, {1.497, 1.42}, {1.599, 1.521}, {1.701, 1.623}},
 {{1.1, 1.189}, {1.238, 1.316}, {1.342, 1.42}, {1.443, 1.521}, {1.557, 1.623}}, 
{{1.189, 1.189}, {1.316, 1.316}, {1.42, 1.42}, {1.521, 1.521}, {1.623, 1.623}}, 
{{1.276, 1.189}, {1.392, 1.316}, {1.497, 1.42}, {1.599, 1.521}, {1.701, 1.623}}}
;

double params_analyzer[9][5][6] =
{{{7, 0.012, 0.134, 0.001, 0.035232, 0.0608339}, {7, 0.014, 0.147, 0.001, 
0.0324887, 0.0593003}, {9, 0.0115, 0.156, 0.001, 0.0298117, 0.0580569}, {9, 
0.012, 0.165, 0.001, 0.0276144, 0.0571104}, {9, 0.0135, 0.177, 0.001, 0.0259968,
 0.056779}}, {{7, 0.0125, 0.144, 0.001, 0.0350284, 0.0604812}, {7, 0.0145, 
0.156, 0.001, 0.0323491, 0.0592013}, {9, 0.0115, 0.165, 0.001, 0.0296224, 
0.0580334}, {9, 0.0125, 0.174, 0.001, 0.0275597, 0.057137}, {9, 0.0135, 0.183, 
0.001, 0.0258734, 0.0563175}}, {{7, 0.0135, 0.15, 0.001, 0.0350179, 0.0587099}, 
{7, 0.015, 0.162, 0.001, 0.0322303, 0.0581241}, {9, 0.012, 0.171, 0.001, 
0.0295693, 0.0570522}, {9, 0.013, 0.18, 0.001, 0.0275097, 0.0562259}, {9, 0.014,
 0.189, 0.001, 0.025828, 0.0554985}}, {{7, 0.012, 0.134, 0.001, 0.035232, 
0.0608339}, {7, 0.014, 0.147, 0.001, 0.0324887, 0.0593003}, {9, 0.0115, 0.156, 
0.001, 0.0298117, 0.0580569}, {9, 0.012, 0.165, 0.001, 0.0276144, 0.0571104}, 
{9, 0.0135, 0.177, 0.001, 0.0259968, 0.056779}}, {{7, 0.0125, 0.144, 0.001, 
0.0350284, 0.0604812}, {7, 0.0145, 0.156, 0.001, 0.0323491, 0.0592013}, {9, 
0.0115, 0.165, 0.001, 0.0296224, 0.0580334}, {9, 0.0125, 0.174, 0.001, 
0.0275597, 0.057137}, {9, 0.0135, 0.183, 0.001, 0.0258734, 0.0563175}}, {{7, 
0.0135, 0.15, 0.001, 0.0350179, 0.0587099}, {7, 0.015, 0.162, 0.001, 0.0322303, 
0.0581241}, {9, 0.012, 0.171, 0.001, 0.0295693, 0.0570522}, {9, 0.013, 0.18, 
0.001, 0.0275097, 0.0562259}, {9, 0.014, 0.189, 0.001, 0.025828, 0.0554985}}, 
{{7, 0.012, 0.134, 0.001, 0.035232, 0.0608339}, {7, 0.014, 0.147, 0.001, 
0.0324887, 0.0593003}, {9, 0.0115, 0.156, 0.001, 0.0298117, 0.0580569}, {9, 
0.012, 0.165, 0.001, 0.0276144, 0.0571104}, {9, 0.0135, 0.177, 0.001, 0.0259968,
 0.056779}}, {{7, 0.0125, 0.144, 0.001, 0.0350284, 0.0604812}, {7, 0.0145, 
0.156, 0.001, 0.0323491, 0.0592013}, {9, 0.0115, 0.165, 0.001, 0.0296224, 
0.0580334}, {9, 0.0125, 0.174, 0.001, 0.0275597, 0.057137}, {9, 0.0135, 0.183, 
0.001, 0.0258734, 0.0563175}}, {{7, 0.0135, 0.15, 0.001, 0.0350179, 0.0587099}, 
{7, 0.015, 0.162, 0.001, 0.0322303, 0.0581241}, {9, 0.012, 0.171, 0.001, 
0.0295693, 0.0570522}, {9, 0.013, 0.18, 0.001, 0.0275097, 0.0562259}, {9, 0.014,
 0.189, 0.001, 0.025828, 0.0554985}}};

double params_detector[9][5][3][2][3] =
{{{{{0.02, 2.27144e-17, 0}, {1.38778e-17, 0.10895, 6.93889e-18}}, {{0, 
-3.30014e-17, 0}, {0, 0.10895, 0}}, {{-0.02, 7.78163e-17, 2.22045e-16}, {0, 
0.10895, 0}}}, {{{0.02, 5.03282e-17, -2.22045e-16}, {-6.93889e-18, 0.121, 
-3.46945e-18}}, {{0, -5.10703e-18, 0}, {-6.93889e-18, 0.121, -3.46945e-18}}, 
{{-0.02, -7.442e-17, -2.22045e-16}, {-6.93889e-18, 0.121, -3.46945e-18}}}, 
{{{0.02, -7.21108e-17, 2.22045e-16}, {6.93889e-17, 0.1304, 9.97466e-18}}, {{0, 
4.30211e-18, 2.22045e-16}, {2.77556e-17, 0.1304, 1.17094e-17}}, {{-0.02, 
4.949e-17, 2.22045e-16}, {2.77556e-17, 0.1304, 1.17094e-17}}}, {{{0.02, 
-6.21095e-17, -2.22045e-16}, {-1.38778e-17, 0.1396, 1.73472e-18}}, {{0, 
2.11081e-17, -4.44089e-16}, {-1.38778e-17, 0.1396, 1.73472e-18}}, {{-0.02, 
1.32081e-16, -6.66134e-16}, {2.77556e-17, 0.1396, -3.46945e-18}}}, {{{0.02, 
5.86741e-17, 2.22045e-16}, {-5.55112e-17, 0.1494, 2.42861e-17}}, {{0, 
-5.18752e-17, 0}, {-5.55112e-17, 0.1494, 2.42861e-17}}, {{-0.02, 4.10902e-18, 
-2.22045e-16}, {-5.55112e-17, 0.1494, 2.42861e-17}}}}, {{{{0.02, -9.83903e-17, 
0}, {1.38778e-17, 0.113, 1.38778e-17}}, {{0, -1.57374e-17, 0}, {-1.38778e-17, 
0.113, 3.46945e-18}}, {{-0.02, -1.63512e-17, 0}, {-1.38778e-17, 0.113, 
3.46945e-18}}}, {{{0.02, 1.30422e-17, -2.22045e-16}, {2.08167e-17, 0.1245, 
-4.33681e-18}}, {{0, -7.21645e-19, 0}, {2.08167e-17, 0.1245, -4.33681e-18}}, 
{{-0.02, -6.07716e-19, 0}, {2.08167e-17, 0.1245, -4.33681e-18}}}, {{{0.02, 
-1.51721e-16, 2.22045e-16}, {0, 0.13395, 1.69136e-17}}, {{-6.93889e-18, 
4.51028e-18, 2.22045e-16}, {0, 0.13395, 1.69136e-17}}, {{-0.02, -4.74251e-17, 
2.22045e-16}, {0, 0.13395, 1.69136e-17}}}, {{{0.02, 4.68697e-17, -2.22045e-16}, 
{5.55112e-17, 0.14315, 3.46945e-18}}, {{5.55112e-17, 6.09929e-17, -4.44089e-16},
 {8.32667e-17, 0.14315, -1.73472e-18}}, {{-0.02, 6.12383e-17, -6.66134e-16}, 
{8.32667e-17, 0.14315, -1.73472e-18}}}, {{{0.02, -1.83983e-16, 2.22045e-16}, 
{-4.16334e-17, 0.1524, 1.73472e-17}}, {{-5.55112e-17, -4.50473e-17, 0}, 
{-4.16334e-17, 0.1524, 1.73472e-17}}, {{-0.02, -2.66934e-16, -2.22045e-16}, 
{-4.16334e-17, 0.1524, 1.73472e-17}}}}, {{{{0.02, -4.91952e-17, 0}, 
{-1.38778e-17, 0.11695, -1.73472e-18}}, {{0, -2.17465e-17, 0}, {-1.38778e-17, 
0.11695, -1.73472e-18}}, {{-0.02, -7.75646e-17, 0}, {-1.38778e-17, 0.11695, 
-1.73472e-18}}}, {{{0.02, -2.73378e-17, -2.22045e-16}, {0, 0.12795, 2.60209e-18}
}, {{0, 7.29972e-18, 0}, {0, 0.12795, 2.60209e-18}}, {{-0.02, -1.35739e-17, 
-2.22045e-16}, {-1.38778e-17, 0.12795, 8.67362e-19}}}, {{{0.02, -1.13843e-16, 
2.22045e-16}, {1.04083e-16, 0.13745, 2.60209e-18}}, {{-6.93889e-18, 2.42861e-18,
 2.22045e-16}, {1.04083e-16, 0.13745, 2.60209e-18}}, {{-0.02, 1.6352e-17, 
2.22045e-16}, {9.02056e-17, 0.13745, 3.46945e-18}}}, {{{0.02, 1.4412e-16, 
-2.22045e-16}, {7.63278e-17, 0.1467, -2.60209e-17}}, {{0, -8.80546e-18, 
-4.44089e-16}, {7.63278e-17, 0.1467, -2.60209e-17}}, {{-0.02, 1.86802e-17, 
-6.66134e-16}, {7.63278e-17, 0.1467, -2.60209e-17}}}, {{{0.02, -3.80617e-17, 
2.22045e-16}, {-6.93889e-17, 0.15595, 1.38778e-17}}, {{-5.55112e-17, 
-3.82194e-17, 0}, {-6.93889e-17, 0.15595, 1.38778e-17}}, {{-0.02, 1.00401e-16, 
-2.22045e-16}, {-6.93889e-17, 0.15595, 1.38778e-17}}}}, {{{{0.02, -2.77556e-17, 
0}, {-4.16334e-17, 0.10895, -1.73472e-17}}, {{5.55112e-17, -1.38778e-17, 0}, 
{-4.16334e-17, 0.10895, -1.73472e-17}}, {{-0.02, -2.77556e-17, 0}, 
{-4.16334e-17, 0.10895, -1.73472e-17}}}, {{{0.02, -2.77556e-17, -2.22045e-16}, 
{-5.89806e-17, 0.121, -8.23994e-18}}, {{0, -6.93889e-18, 0}, {-6.245e-17, 0.121,
 -8.67362e-18}}, {{-0.02, 3.46945e-18, -2.22045e-16}, {-5.89806e-17, 0.121, 
-8.23994e-18}}}, {{{0.02, -4.55585e-19, 2.22045e-16}, {-7.28584e-17, 0.1304, 
4.11997e-18}}, {{-1.38778e-17, 3.01842e-18, 2.22045e-16}, {-7.28584e-17, 0.1304,
 4.11997e-18}}, {{-0.02, 6.49242e-18, 2.22045e-16}, {-7.28584e-17, 0.1304, 
4.11997e-18}}}, {{{0.02, -3.73656e-17, -2.22045e-16}, {-5.55112e-17, 0.1396, 
1.56125e-17}}, {{-5.55112e-17, -9.47506e-18, -4.44089e-16}, {-6.59195e-17, 
0.1396, 1.64799e-17}}, {{-0.02, -6.48512e-17, -6.66134e-16}, {-6.59195e-17, 
0.1396, 1.64799e-17}}}, {{{0.02, 3.48988e-17, 2.22045e-16}, {7.28584e-17, 
0.1494, -2.94903e-17}}, {{0, 6.82787e-18, 0}, {7.28584e-17, 0.1494, 
-2.94903e-17}}, {{-0.02, 8.97792e-17, -2.22045e-16}, {-3.1225e-17, 0.1494, 0}}}}
, {{{{0.02, 0, 0}, {0, 0.113, 0}}, {{0, 0, 0}, {0, 0.113, 0}}, {{-0.02, 0, 0}, 
{0, 0.113, 0}}}, {{{0.02, 0, -2.22045e-16}, {0, 0.1245, 0}}, {{0, 0, 0}, {0, 
0.1245, 0}}, {{-0.02, 0, -2.22045e-16}, {0, 0.1245, 0}}}, {{{0.02, 0, 
2.22045e-16}, {0, 0.13395, 0}}, {{6.93889e-18, 0, 2.22045e-16}, {0, 0.13395, 0}}
, {{-0.02, 0, 2.22045e-16}, {0, 0.13395, 0}}}, {{{0.02, 0, -2.22045e-16}, {0, 
0.14315, 0}}, {{0, 0, -4.44089e-16}, {0, 0.14315, 0}}, {{-0.02, 0, -6.66134e-16}
, {0, 0.14315, 0}}}, {{{0.02, 0, 2.22045e-16}, {0, 0.1524, 0}}, {{0, 0, 
2.22045e-16}, {0, 0.1524, 0}}, {{-0.02, 0, -2.22045e-16}, {0, 0.1524, 0}}}}, 
{{{{0.02, -6.30729e-17, 0}, {-2.08167e-17, 0.11695, -1.73472e-18}}, 
{{5.55112e-17, 6.00908e-18, 0}, {-2.77556e-17, 0.11695, -3.46945e-18}}, {{-0.02,
 -4.9809e-17, 0}, {-2.42861e-17, 0.11695, -2.60209e-18}}}, {{{0.02, 2.03989e-17,
 -2.22045e-16}, {-1.04083e-16, 0.12795, -1.73472e-17}}, {{0, -3.60822e-19, 0}, 
{-1.04083e-16, 0.12795, -1.73472e-17}}, {{-0.02, 3.09212e-17, 0}, {-1.04083e-16,
 0.12795, -1.73472e-17}}}, {{{0.02, 2.10561e-18, 2.22045e-16}, {3.46945e-17, 
0.13745, 2.81893e-18}}, {{-6.93889e-18, -4.68375e-19, 2.22045e-16}, 
{3.46945e-17, 0.13745, 2.81893e-18}}, {{-0.02, -3.90972e-18, 2.22045e-16}, 
{3.46945e-17, 0.13745, 2.81893e-18}}}, {{{0.02, 3.99838e-17, -2.22045e-16}, 
{7.63278e-17, 0.1467, -1.38778e-17}}, {{-5.55112e-17, 5.27703e-18, -4.44089e-16}
, {8.67362e-17, 0.1467, -1.56125e-17}}, {{-0.02, 1.22037e-17, -6.66134e-16}, 
{7.63278e-17, 0.1467, -1.38778e-17}}}, {{{0.02, 2.87506e-17, 4.44089e-16}, 
{1.35308e-16, 0.15595, -4.33681e-17}}, {{0, 7.97973e-19, 2.22045e-16}, 
{1.35308e-16, 0.15595, -4.33681e-17}}, {{-0.02, 4.22342e-17, -2.22045e-16}, 
{1.35308e-16, 0.15595, -4.33681e-17}}}}, {{{{0.02, 0, -2.22045e-16}, {0, 
0.10895, 1.73472e-18}}, {{0, 2.77556e-17, 0}, {0, 0.10895, 1.73472e-18}}, 
{{-0.02, 0, 0}, {6.93889e-18, 0.10895, 3.46945e-18}}}, {{{0.02, 3.29386e-17, 
-2.22045e-16}, {3.46945e-17, 0.121, 8.67362e-18}}, {{-2.77556e-17, -1.83187e-18,
 0}, {-2.08167e-17, 0.121, 8.67362e-19}}, {{-0.02, -8.84671e-18, 0}, 
{3.46945e-17, 0.121, 8.67362e-18}}}, {{{0.02, 1.28673e-17, 2.22045e-16}, 
{-6.93889e-18, 0.1304, -4.11997e-18}}, {{6.93889e-18, 6.93889e-19, 2.22045e-16},
 {-6.93889e-18, 0.1304, -4.11997e-18}}, {{-0.02, 1.10719e-17, 2.22045e-16}, 
{1.38778e-17, 0.1304, -4.98733e-18}}}, {{{0.02, 6.67708e-17, -2.22045e-16}, 
{-2.08167e-17, 0.1396, -1.73472e-18}}, {{0, -2.74086e-18, -4.44089e-16}, 
{-2.08167e-17, 0.1396, -1.73472e-18}}, {{-0.02, 6.65254e-17, -6.66134e-16}, 
{-2.08167e-17, 0.1396, -1.73472e-18}}}, {{{0.02, -2.77556e-17, 2.22045e-16}, 
{-1.38778e-17, 0.1494, 1.73472e-18}}, {{-5.55112e-17, -2.77556e-17, 0}, 
{2.77556e-17, 0.1494, -8.67362e-18}}, {{-0.02, 2.77556e-17, -2.22045e-16}, 
{2.77556e-17, 0.1494, -8.67362e-18}}}}, {{{{0.02, 9.83903e-17, 0}, 
{-1.38778e-17, 0.113, -1.38778e-17}}, {{0, 1.57374e-17, 0}, {1.38778e-17, 0.113,
 -3.46945e-18}}, {{-0.02, 1.63512e-17, 0}, {1.38778e-17, 0.113, -3.46945e-18}}},
 {{{0.02, -1.30422e-17, -2.22045e-16}, {-2.08167e-17, 0.1245, 4.33681e-18}}, 
{{0, 7.21645e-19, 0}, {-2.08167e-17, 0.1245, 4.33681e-18}}, {{-0.02, 
6.07716e-19, 0}, {-2.08167e-17, 0.1245, 4.33681e-18}}}, {{{0.02, 1.51721e-16, 
2.22045e-16}, {0, 0.13395, -1.69136e-17}}, {{-6.93889e-18, -4.51028e-18, 
2.22045e-16}, {0, 0.13395, -1.69136e-17}}, {{-0.02, 4.74251e-17, 2.22045e-16}, 
{0, 0.13395, -1.69136e-17}}}, {{{0.02, -4.68697e-17, -2.22045e-16}, 
{-5.55112e-17, 0.14315, -3.46945e-18}}, {{5.55112e-17, -6.09929e-17, 
-4.44089e-16}, {-8.32667e-17, 0.14315, 1.73472e-18}}, {{-0.02, -6.12383e-17, 
-6.66134e-16}, {-8.32667e-17, 0.14315, 1.73472e-18}}}, {{{0.02, 1.83983e-16, 
2.22045e-16}, {4.16334e-17, 0.1524, -1.73472e-17}}, {{-5.55112e-17, 4.50473e-17,
 0}, {4.16334e-17, 0.1524, -1.73472e-17}}, {{-0.02, 2.66934e-16, -2.22045e-16}, 
{4.16334e-17, 0.1524, -1.73472e-17}}}}, {{{{0.02, 5.55112e-17, 0}, {4.85723e-17,
 0.11695, 1.73472e-17}}, {{0, -2.77556e-17, 0}, {4.85723e-17, 0.11695, 
1.73472e-17}}, {{-0.02, -2.77556e-17, 0}, {4.85723e-17, 0.11695, 1.73472e-17}}},
 {{{0.02, 2.60844e-17, -2.22045e-16}, {0, 0.12795, -1.04083e-17}}, 
{{-2.77556e-17, 1.24345e-17, 0}, {-2.77556e-17, 0.12795, -1.21431e-17}}, 
{{-0.02, -1.21543e-18, 0}, {4.16334e-17, 0.12795, -3.46945e-18}}}, {{{0.02, 
-1.05357e-16, 2.22045e-16}, {-1.38778e-17, 0.13745, 4.33681e-18}}, {{0, 
-1.16573e-17, 2.22045e-16}, {-1.38778e-17, 0.13745, 4.33681e-18}}, {{-0.02, 
-8.79609e-17, 2.22045e-16}, {-1.38778e-17, 0.13745, 4.33681e-18}}}, {{{0.02, 
-7.1432e-17, -2.22045e-16}, {1.38778e-17, 0.1467, 1.04083e-17}}, {{-5.55112e-17,
 -1.56264e-17, -4.44089e-16}, {1.38778e-17, 0.1467, 1.04083e-17}}, {{-0.02, 
1.24237e-17, -6.66134e-16}, {1.38778e-17, 0.1467, 1.04083e-17}}}, {{{0.02, 
-6.26544e-17, 2.22045e-16}, {4.16334e-17, 0.15595, 0}}, {{-5.55112e-17, 
4.86833e-17, 0}, {1.66533e-16, 0.15595, -3.81639e-17}}, {{-0.02, 1.32265e-16, 
-2.22045e-16}, {4.16334e-17, 0.15595, 0}}}}};

double params_channel[9] =
{-0.698132, -0.523599, -0.349066, -0.174533, 0, 0.174533, 0.349066, 0.523599, 
0.698132};

double params_two_theta[9][5] =
{{1.92394, 1.70678, 1.52704, 1.39577, 1.29404}, {1.92394, 1.70678, 1.52704, 
1.39577, 1.29404}, {1.92394, 1.70678, 1.52704, 1.39577, 1.29404}, {1.92394, 
1.70678, 1.52704, 1.39577, 1.29404}, {1.92394, 1.70678, 1.52704, 1.39577, 
1.29404}, {1.92394, 1.70678, 1.52704, 1.39577, 1.29404}, {1.92394, 1.70678, 
1.52704, 1.39577, 1.29404}, {1.92394, 1.70678, 1.52704, 1.39577, 1.29404}, 
{1.92394, 1.70678, 1.52704, 1.39577, 1.29404}};
%}
INITIALIZE
%{
%}
TRACE
FINALLY
%{
%}
END